<template>
    <div>
      <!-- Display the current title -->
      <h1>{{title}}</h1>
  
      <!-- Input field to change the title dynamically -->
      <input 
        type="text" 
        id="titleInput" 
        placeholder="Change title" 
        oninput="updateTitle(event)" 
        value="{{title}}" 
      />
  
      <!-- Input field to add a new item -->
      <input 
        type="text" 
        id="itemInput" 
        placeholder="Enter item name" 
      />
      <button onclick="addItem()">Add Item</button>
  
      <!-- Display list of items with a Remove button -->
      <loop values="item in items.value">
        <div>
          <span>Item: {{item.name}}</span>
          <button onclick="removeItem({{item.id}})">Remove</button>
        </div>
      </loop>
      
      <p>Total items: {{items.value.length}}</p>
    </div>
  </template>
  
  <script>
    // Initialize the title and items using Blip for reactivity
    const title = new Blip('Hello, NanoJS!');
    const items = new Blip([
      { id: 1, name: 'Item 1' },
      { id: 2, name: 'Item 2' }
    ]);
  
    // Function to update the title without causing a full re-render
    window.updateTitle = function(event) {
      const newValue = event.target.value;
      
      // Update the Blip value only if it has changed
      if (title.value !== newValue) {
        title.value = newValue;
        console.log("Title updated:", title.value);
  
        // Manually update the input field to avoid losing focus
        const titleInput = document.getElementById('titleInput');
        if (titleInput && titleInput !== document.activeElement) {
          titleInput.focus();
          titleInput.setSelectionRange(newValue.length, newValue.length);
        }
      }
    };
  
    // Function to add a new item to the list
    window.addItem = function() {
      const inputElement = document.getElementById('itemInput');
      const itemName = inputElement.value.trim();
  
      if (itemName === '') {
        alert('Please enter an item name.');
        return;
      }
  
      const newItem = { 
        id: Date.now(),
        name: itemName
      };
  
      // Add the new item to the list
      items.value = [...items.value, newItem];
      console.log("Item added. Current items:", items.value);
  
      // Clear the input field after adding
      inputElement.value = '';
    };
  
    // Function to remove an item by its ID
    window.removeItem = function(itemId) {
      items.value = items.value.filter(item => item.id !== itemId);
      console.log("Item removed. Current items:", items.value);
    };
  </script>
  
  <style>
    h1 {
      color: #007acc;
      margin-bottom: 20px;
    }
    button {
      margin: 5px;
      padding: 5px 10px;
      cursor: pointer;
    }
    input {
      margin-right: 10px;
      padding: 5px;
      width: 200px;
    }
    div {
      margin-bottom: 10px;
    }
    p {
      font-weight: bold;
      margin-top: 20px;
    }
  </style>
  